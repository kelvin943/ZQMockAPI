const { resolve } = require("path");
const { copyFileSync, existsSync, readFileSync, writeFileSync } = require("fs");

const src = resolve(__dirname, "templates", "babelrc.json");
const dist = resolve(__dirname, "../../../", ".babelrc");

const pkgsrc = resolve(__dirname, "package.json");
const pkgdist = resolve(__dirname, "../../../", "package.json");

const olds = require(pkgdist);
const { dependencies } = require(pkgsrc);

const newspkg = {
  ...olds,
  dependencies: {
    "@babel/runtime": dependencies["@babel/runtime"],
    ...olds.dependencies
  }
};

if (!existsSync(dist)) {
  copyFileSync(src, dist);
}

writeFileSync(pkgdist, JSON.stringify(newspkg, null, 2));
